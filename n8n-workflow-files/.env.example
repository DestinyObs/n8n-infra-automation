# ================================================================
# COMPLETE CONFIGURATION - All Services Included
# ================================================================
# Copy to .env:  cp env-complete.txt .env
# Then fill in your actual values

# ================================================================
# REQUIRED - Get These First!
# ================================================================

# n8n Admin Password
N8N_PASSWORD=admin123

# Your Server IP (or localhost for testing)
SERVER_IP=localhost

# FREE Gemini API Key (REQUIRED)
# Get at: https://makersuite.google.com/app/apikey
# Steps:
#   1. Go to https://makersuite.google.com/app/apikey
#   2. Click "Create API Key"
#   3. Copy the key (starts with AIza...)
GEMINI_API_KEY=AIzaSy...your_key_here

# Slack Bot Token (REQUIRED)
# Get at: https://api.slack.com/apps
# Steps:
#   1. Create new app at https://api.slack.com/apps
#   2. Go to OAuth & Permissions
#   3. Add scopes: chat:write, chat:write.public, channels:read
#   4. Install to workspace
#   5. Copy "Bot User OAuth Token" (starts with xoxb-)
SLACK_TOKEN=xoxb-your-token-here

# Slack Channel (REQUIRED)
# The channel where alerts will be sent
# Make sure to invite your bot to this channel:
#   /invite @DevOps Alert Bot
SLACK_CHANNEL=#devops-alerts

# ================================================================
# OPTIONAL - AWS Auto-Scaling (Can skip for demo)
# ================================================================

# AWS API Gateway Key
# See instructions below on how to get this
AWS_API_KEY=

# AWS Lambda API Gateway URL
# Format: https://{api-id}.execute-api.{region}.amazonaws.com/prod/auto-scale
LAMBDA_API_GATEWAY_URL=

# AWS Auto Scaling Group Configuration
AWS_REGION=us-east-1
ASG_NAME=production-asg
MIN_INSTANCES=2
MAX_INSTANCES=10
SCALE_UP_AMOUNT=2

# ================================================================
# HOW TO GET AWS API KEYS (Optional - For Real Auto-Scaling)
# ================================================================
#
# If you want actual AWS auto-scaling (not just simulation):
#
# Step 1: Deploy Lambda Function
# --------------------------------
# cd lambda
# zip auto_scale_handler.zip auto_scale_handler.py
# 
# aws lambda create-function \
#   --function-name auto-scale-handler \
#   --runtime python3.11 \
#   --handler auto_scale_handler.lambda_handler \
#   --zip-file fileb://auto_scale_handler.zip \
#   --role arn:aws:iam::YOUR_ACCOUNT:role/lambda-execution-role \
#   --environment Variables="{ASG_NAME=production-asg}"
#
# Step 2: Create API Gateway
# ---------------------------
# AWS Console → API Gateway → Create REST API
#
# Using AWS CLI:
# API_ID=$(aws apigateway create-rest-api \
#   --name "autoscale-api" \
#   --query 'id' --output text)
#
# ROOT_ID=$(aws apigateway get-resources \
#   --rest-api-id $API_ID \
#   --query 'items[0].id' --output text)
#
# RESOURCE_ID=$(aws apigateway create-resource \
#   --rest-api-id $API_ID \
#   --parent-id $ROOT_ID \
#   --path-part auto-scale \
#   --query 'id' --output text)
#
# aws apigateway put-method \
#   --rest-api-id $API_ID \
#   --resource-id $RESOURCE_ID \
#   --http-method POST \
#   --authorization-type NONE
#
# aws apigateway put-integration \
#   --rest-api-id $API_ID \
#   --resource-id $RESOURCE_ID \
#   --http-method POST \
#   --type AWS_PROXY \
#   --integration-http-method POST \
#   --uri arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:ACCOUNT:function:auto-scale-handler/invocations
#
# aws apigateway create-deployment \
#   --rest-api-id $API_ID \
#   --stage-name prod
#
# Your URL will be:
# https://${API_ID}.execute-api.us-east-1.amazonaws.com/prod/auto-scale
#
# Step 3: Create API Key
# -----------------------
# aws apigateway create-api-key \
#   --name "n8n-key" \
#   --enabled \
#   --query 'value' --output text
#
# Copy the output and paste above as AWS_API_KEY
#
# ================================================================

# ================================================================
# VERIFICATION COMMANDS
# ================================================================
#
# Test Gemini API:
# ----------------
# curl "https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=$GEMINI_API_KEY" \
#   -H "Content-Type: application/json" \
#   -d '{"contents":[{"parts":[{"text":"test"}]}]}'
#
# Test Slack Token:
# -----------------
# curl -X POST https://slack.com/api/auth.test \
#   -H "Authorization: Bearer $SLACK_TOKEN"
#
# Test AWS Lambda (if configured):
# ---------------------------------
# curl -X POST $LAMBDA_API_GATEWAY_URL \
#   -H "x-api-key: $AWS_API_KEY" \
#   -H "Content-Type: application/json" \
#   -d '{"alert_type":"test","action":"scale_up"}'
#
# ================================================================

# ================================================================
# QUICK START CHECKLIST
# ================================================================
# 
# □ Get Gemini API key from https://makersuite.google.com/app/apikey
# □ Create Slack app and get token from https://api.slack.com/apps
# □ Create #devops-alerts channel in Slack
# □ Invite bot to channel: /invite @DevOps Alert Bot
# □ Copy this file to .env
# □ Fill in GEMINI_API_KEY
# □ Fill in SLACK_TOKEN
# □ Run: docker-compose -f docker-compose-complete.yml up -d
# □ Import workflow: configs/n8n-workflow-with-slack.json
# □ Add Slack credentials in n8n
# □ Activate workflow
# □ Test: cd scripts && ./test_workflow.sh
# □ Check Slack for notification!
#
# ================================================================